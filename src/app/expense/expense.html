<div class="expense-wrapper">
  <h2>Expense Management</h2>

  <!-- Add Expense Form -->
  <div class="expense-form card">

    <!-- Dynamic heading based on mode -->
    <h3>{{ editMode ? 'Update Expense' : 'Add New Expense' }}</h3>

    <form (ngSubmit)="submitExpense()" enctype="multipart/form-data">

      <!-- Employee ID and Expense Type ID inputs -->
      <div class="form-group">
        <input placeholder="Employee Id" type="number" [(ngModel)]="newExpense.employeeId" name="employeeId" required>
        <input type="number" placeholder="Expense Type Id" [(ngModel)]="newExpense.expensetypeId" name="expensetypeId"
          required>
      </div>

      <!-- Amount and Receipt File Upload -->
      <div class="form-group">
        <input type="number" placeholder="Amount" [(ngModel)]="newExpense.amount" name="amount" required>
        <input type="file" (change)="onFileChange($event)">
      </div>

      <!-- Description textarea -->
      <textarea placeholder="Description" [(ngModel)]="newExpense.description" name="description" required></textarea>

      <!-- Submit button changes text based on editMode -->
      <button type="submit" class="btn-primary">
        {{ editMode ? 'Update Expense' : 'Add Expense' }}
      </button>

      <!-- Cancel button shown only in edit mode to reset form -->
      <button type="button" *ngIf="editMode" class="btn-secondary" (click)="resetForm()">
        Cancel
      </button>
    </form>
  </div>

  <hr>

  <!-- Expenses Table -->
  <div class="expense-table card">
    <h3>All Expenses</h3>
    <div class="table-responsive">
      <table>
        <thead>
          <tr>
            <th>ExpenseID</th>
            <th>Employee Name</th>
            <th>Type</th>
            <th>Amount</th>
            <th>Description</th>
            <th>Receipt</th>
            <th>Status</th>
            <th>PaymentStatus</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let expense of expenses">
            <td>{{expense.expenseId}}</td>
            <td>{{expense.employeeName}}</td>
            <td>{{expense.expenseTypeName}}</td>
            <td>â‚¹{{expense.amount}}</td>
            <td>{{expense.description}}</td>
            <td>
              <a *ngIf="expense.receiptUrl" [href]="expense.receiptUrl" target="_blank" class="btn-view">View</a>
            </td>
            <td>
              <span class="status" [ngClass]="expense.status.toLowerCase()">{{expense.status}}</span>
            </td>
            <td>
              <span class="payment-status" [ngClass]="expense.paymentStatus?.toLowerCase()">
                {{ expense.paymentStatus }}
              </span>
            </td>
            <td>
              <button class="btn-delete" (click)="deleteExpense(expense.expenseId)">Delete</button>&nbsp;
              <button class="btn-update" (click)="editExpense(expense)">Edit</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>